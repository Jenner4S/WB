{"hidden":true,"children":[{"configs":{"head":"<style type=\"text/css\">\n.dataset table{border-collapse:collapse;border-spacing:0;border-left:1px solid #000;border-top:1px solid #000;}\n.dataset th,.dataset td{border-right:1px solid #000;border-bottom:1px solid #000;padding:5px 15px;}\n.dataset th{font-weight:bold;}\nul {\nmargin: 0px 0px 0px 0px;\npadding: 0px 0px 0px 0px;\n}\nul li{\nlist-style-type:none;\n}\n<\/style>","itemId":"module"},"expanded":true,"children":[{"configs":{"itemId":"viewport1","html":"<style type=\"text/css\">\n.dataset table{border-collapse:collapse;border-spacing:0;border-left:1px solid #000;border-top:1px solid #000;}\n.dataset th,.dataset td{border-right:1px solid #000;border-bottom:1px solid #000;padding:5px 15px;}\n.dataset th{font-weight:bold;}\nul {\nmargin: 0px 0px 0px 0px;\npadding: 0px 0px 0px 0px;\n}\nul li{\nlist-style-type:none;\n}\n<\/style>\n\n<div  id=\"div1\" style=\"width: 1200px;\">\n    <table width=\"100%\">\n        <tr>\n            <td>\n                <table width=\"100%\">\n                    <tr>\n                        <td rowspan=\"3\" width=\"100px\" style=\"padding-left:10px\"><img src=\"wb/images/site/sales_ht.png\"/><\/td>\n                        <td colspan=\"11\" style=\"text-align: center;font-weight: 700;font-size: 17pt\">WELLHEAD SOLUTIONS CO., LTD.<\/td>\n                    <\/tr>\n                    <tr>\n                        <td colspan=\"12\" style=\"text-align: center;font-weight: 700;font-size: 10pt\">NO 888 ZHONGQIANG ROAD, MAOGANG TOWN,SONGJIANG ,SHANGHAI CHINA.201607 TEL: 86-21-57868786  FAX: 86-21-57866958<\/td>\n                    <\/tr>\n                    <tr>\n                        <td colspan=\"12\" style=\"text-align: center;font-weight: 700;font-size: 15pt;height: 30px;\">QUOTATION SHEET<\/td>\n                    <\/tr>\n                <\/table>\n            <\/td>\n        <\/tr>\n        <tr>\n            <td colspan=\"12\">&nbsp;<\/td>\n        <\/tr>\n        <tr>\n            <td>\n                <table width=\"100%\">\n                    <td colspan=\"4\" width=\"33%\">\n                        <table width=\"100%\" style=\"border: 1px solid #000\" id=\"TOUSERTB\">\n                            <tr>\n                                <td>TO.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"TO\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>ATTN.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"ATTN\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>ADD.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"ADD\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>TEL.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"TEL\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>FAX.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"FAX\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>EMAIL.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"EMAIL\"><\/td>\n                            <\/tr>\n                        <\/table>\n                    <\/td>\n                    <td colspan=\"3\" width=\"25%\">&nbsp;<\/td>\n                    <td colspan=\"5\" width=\"42%\">\n                        <table width=\"100%\" style=\"border: 1px solid #000\"  id=\"QUOTETB\">\n                            <tr>\n                                <td>QUOTE NO.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"QUOTE_NO\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>REV.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"REV\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>QUOTE DATE.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\"  id=\"QUOTE_DATE\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>QUOTATED BY.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\"  id=\"CUST_BUYER\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>EMAIL.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"CUST_EMAIL\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>RFQ NO.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"RFQ_REF\"><\/td>\n                            <\/tr>\n                        <\/table>\n                    <\/td>\n                <\/table>\n            <\/td>\n        <\/tr>\n        <tr>\n            <td colspan=\"12\" height=\"30px\"><\/td>\n        <\/tr>\n        <tr>\n            <td colspan=\"12\">\n                <table width=\"100%\" class=\"dataset\" style=\"border: 1px solid #000\" cellpadding=\"0\" cellspacing=\"0\">\n                  \t<thead>  \n                  \t<tr style=\"    background: #00CC99;\">\n                        <th>QUOTE NO.<\/th>\n                        <th>FIN P/N.<\/th>\n                        <th>FIN P/N REV.<\/th>\n                        <th>RFQ NOTES<\/th>\n                        <th>QTY<\/th>\n                        <th>UOM<\/th>\n                        <th>MAT'L GRADE<\/th>\n                        <th>UNIT COST(￥) EXCL 17% VAT<\/th>\n                        <th>UNIT COST(￥) INCL 17% VAT<\/th>\n                        <th>EXCHANGE RATE<\/th>\n                        <th>OFFER($)<\/th>\n                        <th>LEAD TIME<\/th>\n                    <\/tr>\n                    <\/thead>\n                  \t<tbody id=\"datasetTbody\">\n                    <tr>\n                        <td>&nbsp;<\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                    <\/tr>\n                    <tr>\n                        <td>&nbsp;<\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                    <\/tr>\n                    <tr>\n                        <td>&nbsp;<\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                    <\/tr>\n                    <tr>\n                        <td>&nbsp;<\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                    <\/tr>\n                    <tr>\n                        <td>&nbsp;<\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                        <td><\/td>\n                    <\/tr>\n                  \t<\/tbody>\n                <\/table>\n            <\/td>\n        <\/tr>\n        <tr style=\"height:10px;\">\n            <td>&nbsp;<\/td>\n        <\/tr>\n        <tr>\n            <td>\n                <table width=\"100%\">\n                    <tr>\n                        <td style=\"text-align: left;font-weight: 700;font-size: 17pt\">NOTES:<\/td>\n                    <\/tr>\n                    <tr>\n                        <td style=\"border: 1px solid #000\">\n                            <ul id=\"notesUl\">\n                                \n                            <\/ul>\n                        <\/td>\n                    <\/tr>\n                <\/table>\n            <\/td>\n        <\/tr>\n        <tr>\n            <td>\n                <table width=\"100%\" id=\"LU_TB\">\n                    <tr>\n                        <td width=\"12%\">\n                            报价人\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"BAOJIAREN\" />\n                        <\/td>\n                        <td width=\"12%\">\n                            审核人\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"SHENHEREN\" />\n                        <\/td>\n                        <td width=\"12%\">\n                            批准\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"PIZHUN\" />\n                        <\/td>\n                    <\/tr>\n                    <tr>\n                        <td width=\"12%\">\n                            日期\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"BAOJIA_DATE\" />\n                        <\/td>\n                        <td width=\"12%\">\n                            日期\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"SHENHEREN_DATE\" />\n                        <\/td>\n                        <td width=\"12%\">\n                            日期\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"PIZHUN_DATE\" />\n                        <\/td>\n                    <\/tr>\n                <\/table>\n            <\/td>\n        <\/tr>\n    <\/table>\n<\/div>"},"expanded":true,"children":[{"configs":{"itemId":"panel1"},"expanded":true,"children":[{"configs":{"itemId":"exportBtn","text":"导出Excel"},"expanded":false,"children":[],"type":"button","events":{"click":"/*\n * 从界面上获取到所有html的字段id和value\n * \n */\nvar list = document.getElementsByTagName(\"input\");\nvar params = {};\nfor(var i=0;i<list.length;i++){\n    if(list[i].type==\"text\"){\n\t\tparams[list[i].id] = list[i].value;\n    }\n}\n\n\nvar datasetTbody = document.getElementById(\"datasetTbody\");\nfor(var i=0;i<datasetTbody.rows.length;i++){\n\tvar cell = datasetTbody.rows[i].cells;\n  \tparams.OUR_REF_NO = cell[0].innerText;\n  \tparams.FINISH_P_N = cell[1].innerText;\n  \tparams.FINISH_PART_REV = cell[2].innerText;\n  \tparams.DESC = cell[3].innerText;\n  \tparams.QTY = cell[4].innerText;\n  \tparams.UOM = cell[5].innerText;\n  \tparams.MATERIAL_TYPE = cell[6].innerText;\n  \tparams.UNIT_PRICE_EXCLUE_VAT = cell[7].innerText;\n  \tparams.EXT_PRICE_EXCLUDE_VAT = cell[8].innerText;\n  \tparams.CURRENCY_CODE = cell[9].innerText;\n  \tparams.PRICE_TEAMS = cell[10].innerText;\n  \tparams.LEAD_TIME = cell[11].innerText;\n  \tbreak;\n}\n\nvar notesUls  = document.getElementsByName(\"notesUl\");\nvar index = 0;\nvar noteStr = \"\";\nfor(var i=0;i<notesUls.length;i++){\n    if(notesUls[i].checked){\n \t\tvar txt = notesUls[i].parentNode.innerText.trim();\n      \ttxt = txt.substring(txt.indexOf(\".\"));\n        noteStr += (index+1) + txt + \"\\n\";\n        index++;\n    }\n}\n\nparams.notesUl = noteStr;\n\nWb.download('m?xwl=my/sales/export_excel/exportExcel', {\n  filename: 'filename',\n  title: '标题',\n  jsonStr : Ext.JSON.encode(params)\n});"}},{"configs":{"itemId":"resetBtn","text":"重置"},"expanded":false,"children":[],"type":"button"}],"type":"panel"}],"type":"viewport"}],"type":"module","events":{"initialize":"//\nvar id = '{#id#}';\nif(id == null || id == \"\"){\n\tid = 1;\n}\nWb.request({\n  url: 'm?xwl=my/sales/offer/offer-select-by-ID',\n  params : {\n  \tid : id\n  },\n  success: function(resp) {\n//WebUtil.forward(request, response, 'dbe'); //转发到数据库浏览器\n    var obj = Ext.JSON.decode(resp.responseText);\n\tif(obj != null){\n      document.getElementById(\"TO\").value = obj.SALES_PERSON;\n      document.getElementById(\"QUOTE_NO\").value = obj.QUOTE_NO;\n      document.getElementById(\"REV\").value = obj.FIN_P_N_REV;\n      document.getElementById(\"QUOTE_DATE\").value = obj.QUOTE_DATE;\n      document.getElementById(\"CUST_BUYER\").value = obj.CUST_BUYER;\n      document.getElementById(\"CUST_EMAIL\").value = obj.EMAIL;\n      document.getElementById(\"RFQ_REF\").value = obj.RFQ_REF;\n      \n      var datasetTbody = document.getElementById(\"datasetTbody\");\n      datasetTbody.rows[0].cells[0].innerHTML = obj.QUOTE_NO;\n      datasetTbody.rows[0].cells[1].innerHTML = obj.FIN_P_N;\n      datasetTbody.rows[0].cells[2].innerHTML = obj.FIN_P_N_REV;\n      datasetTbody.rows[0].cells[3].innerHTML = obj.RFQ_NOTES;\n      datasetTbody.rows[0].cells[4].innerHTML = obj.QTY;\n      datasetTbody.rows[0].cells[5].innerHTML = obj.UOM;\n      datasetTbody.rows[0].cells[6].innerHTML = obj.MAT_L_GRADE;\n      datasetTbody.rows[0].cells[7].innerHTML = obj.UNIT_COST_EXCL_17_VAT;\n      datasetTbody.rows[0].cells[8].innerHTML = obj.UNIT_COST_INCL_17_VAT;\n      datasetTbody.rows[0].cells[9].innerHTML = obj.EXCHANGE_RATE;\n      datasetTbody.rows[0].cells[10].innerHTML = obj.OFFER;\n      datasetTbody.rows[0].cells[11].innerHTML = obj.LEAD_TIME;\n    }\n  }\n});\n\nWb.request({\n  url: 'm?xwl=my/sales/offer/select',\n  success: function(resp) {\n//WebUtil.forward(request, response, 'dbe'); //转发到数据库浏览器\n    var ret = Ext.JSON.decode(resp.responseText);\n    if(ret.rows != null && ret.rows.length>0){\n    \tvar ul = document.getElementById(\"notesUl\");\n      \tvar liStr = \"\";\n      \tfor(var i=0;i<ret.rows.length;i++){\n        \tliStr += '<li><label><input type=\"checkbox\" name=\"notesUl\"> ' + (i+1) + \".\" + ret.rows[i].V + '<\/label><\/li>';\n        }\n      \tul.innerHTML = liStr;\n    }\n  }\n});\n\n"}}],"roles":{"default":1,"user":1},"title":"导出html界面","iconCls":"","inframe":false,"pageLink":""}