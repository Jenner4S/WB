{"hidden":false,"children":[{"configs":{"serverScript":"var result = {},\n  records = {},\n  record, nodes, rs, meta,sql,params = app.get();\nsql = 'select * from region where 1=1 ';\nif (!Wb.isEmpty(params.regionCode)) {\n  sql += \" and regionCode  = {?regionCode?}\";\n}\n\nsql += \" order by regionCode\";\nrs = app.run(sql);\nmeta = rs.getMetaData();\nwhile (rs.next()) {\n  //获取结果集当前行所有字段名称和值组成的对象。rs:结果集。meta:结果集元数据，如果缺少该值，系统将动态生成。基于性能考虑如果多次调用该方法，请提供该参数。\n  record = Wb.getRecord(rs, meta);\n  Wb.apply(record, {\n    text: record.fullName,\n    iconCls: 'db_field_icon'\n  });\n  nodes = records[record.parentCode];\n  \n  if (nodes) {\n    nodes.push(record);\n  } else {\n    nodes = [record];\n    records[record.parentCode] = nodes;\n  }\n}\n\nfunction createNodes(items, parentC) {\n  items.children = records[parentC] || [];\n  if (items.children.length){\n    items.expanded = false;\n  }\n  if(parentC == '100000'){\n    items.expanded = true;\n  }\n    \n  Wb.each(items.children, function(item) {\n    createNodes(item, item.regionCode);\n  });\n}\ncreateNodes(result, '0');\napp.send(result);","itemId":"module"},"expanded":false,"children":[],"type":"module"}],"roles":{"demo":1},"title":"查询","iconCls":"","inframe":false,"pageLink":""}