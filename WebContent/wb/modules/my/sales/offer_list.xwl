{"hidden":false,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"itemId":"toolbar2"},"expanded":false,"children":[{"configs":{"itemId":"searchCombo","onTriggerClick":"this.collapse();\napp.pickComp.store.load({\n  out: app.toolbar1\n});","emptyText":"FILTER CONDITION","triggerCls":"x-form-search-trigger","fieldLabel":"FILTER","width":"250","displayField":"FIN_P_N","enterKeyTriggerClick":"true"},"expanded":true,"children":[{"configs":{"itemId":"store","url":"m?xwl=my/sales/product/product-search"},"expanded":false,"children":[],"type":"store"}],"type":"combo","events":{"select":"Ext.callback(combo.onTriggerClick, combo);"}}],"type":"toolbar"},{"configs":{"itemId":"viewport1"},"expanded":true,"children":[{"configs":{"itemId":"toolbar1","region":"north"},"expanded":true,"children":[{"configs":{"itemId":"item1","text":"-"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"addBtn","text":"Add Record","iconCls":"record_add_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"app.isEdit = false;\nWb.open({url: 'm?xwl=my/sales/offer/offer_add', title: 'NEW RECORDE', inframe:true, iconCls: 'record_add_icon'});"}},{"configs":{"itemId":"item2","text":"-"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"editBtn","text":"Edit","iconCls":"record_edit_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"app.isEdit = true;\n//使用下面方法用于演示完整的步骤\nvar recs = app.grid1.getSelection();\nif (!recs.length) {\n  Wb.warn('请选择一条记录。');\n  return;\n}\nvar obj = Wb.getData(recs, true);\nWb.open({url: 'm?xwl=my/sales/offer/offer_add&id='+obj[0].ID, title: 'EDIT RECORDE',  inframe:true, iconCls: 'record_edit_icon'});"}},{"configs":{"itemId":"item21","text":"-"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"delBtn","text":"Remove","iconCls":"record_delete_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"//使用下面方法用于演示完整的步骤\nvar recs = app.grid1.getSelection();\nif (!recs.length) {\n  Wb.warn('请选择需要删除的记录。');\n  return;\n}\nWb.confirm('确定要删除选择的 ' + recs.length + ' 条记录吗？', function() {\n  Wb.request({\n    url: 'm?xwl=my/sales/offer/delete', //使用basic-delete.xwl用于演示目的，建议使用delete.xwl\n    params: {\n      destroy: Wb.getData(recs, true)\n    },\n    success: function() {\n      Wb.remove(app.grid1, recs);\n       Wb.toast('数据删除成功。');\n    }\n  });\n});"}},{"configs":{"itemId":"item3","text":"-"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"offerListBtn","text":"Offer List","iconCls":"file_xls_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"if(app.store.getCount() == 0){\n  Wb.warn(\"没有数据,无法导出\");\n  return false;\n}\nWb.exportData(app.grid1,\"excel\",true);"}},{"configs":{"itemId":"item31","text":"-"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"QuotationBtn","text":"Quotation","iconCls":"printer_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"var selected = app.grid1.getSelectionModel().getSelection();\nvar ids = [];\nExt.each(selected, function (item) {\n  ids.push(item.data.ID);\n});\nif(selected.length >30){\n\tWb.info('最多只能选择 30 条记录！');\n  \treturn;\n}\n\n//console.log(Wb.getData(selected, true));\n\nWb.open({url: 'm?xwl=my/sales/export_excel/exportHtml&id=' + Ext.encode(ids), title: 'Quotation', inframe:true, iconCls: 'printer_icon'});\n/*\nWb.request({\n  url: 'm?xwl=my/sales/export_excel/exportHtml',\n  params : data[0].data,\n  success: function(resp) {\n//WebUtil.forward(request, response, 'dbe'); //转发到数据库浏览器\n    Wb.info('test');\n  }\n});\n*/"}},{"configs":{"itemId":"item4","text":"-"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"queryBtn","text":"QUERY","iconCls":"seek_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"app.grid1.store.load({\n  out: app.queryForm\n});"}},{"configs":{"itemId":"item41","text":"-"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"resetBtn","text":"RESET","iconCls":"file_default_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"Wb.reset(app.queryForm);"}}],"type":"toolbar"},{"configs":{"layout":"@{type: 'vbox',align:'stretch'}","itemId":"container1","defaults":"{\n  flex: 1,\n  margin: 8\n}","region":"center"},"expanded":true,"children":[{"configs":{"itemId":"queryForm"},"expanded":true,"children":[{"configs":{"layout":"anchor","itemId":"panel1","defaults":"{\n  labelAlign: 'right',\n  margin: '8 0 0 0',\n  anchor: '-8'\n}","bodyPadding":"2 10 10 10","title":"QUERY INPUT"},"expanded":true,"children":[{"configs":{"layout":"column","border":"false","itemId":"panel1"},"expanded":false,"children":[{"configs":{"tagConfigs":"{\n  columnWidth: 1 / 4\n}","itemId":"QUOTE_NO","fieldLabel":"QUOTE NO","width":"200"},"expanded":false,"children":[],"type":"text"},{"configs":{"tagConfigs":"{   \n  columnWidth: 1 / 4 \n}","itemId":"CUST_BUYER","labelAlign":"left","fieldLabel":"CUST/BUYER"},"expanded":false,"children":[],"type":"text"},{"configs":{"tagConfigs":"{   columnWidth: 1 / 4 }","itemId":"CUST","queryMode":"local","fieldLabel":"CUST","displayField":"codeName","queryCaching":"true","valueField":"CODE","anyMatch":"true"},"expanded":false,"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=my/cust/cust-select"},"expanded":false,"children":[],"type":"store"}],"type":"combo","events":{"select":"\nif(combo.getValue() != null && combo.getValue() != \"\" ){\n  \tvar index = combo.getStore().find(\"CODE\",combo.getValue(),0,false,true,true);\n\tapp[\"CUST_BUYER\"].setValue(combo.getStore().getAt(index).get(\"NAME\"));\n  \tapp.CUST_ID.setValue(records[0].get(\"ID\"));\n}else{\n\tapp[\"CUST_BUYER\"].setValue(\"\");\n}","change":"if(combo.getValue() != null && combo.getValue() != \"\" ){\n  \tvar index = combo.getStore().find(\"CODE\",combo.getValue(),0,false,true,true);\n\tapp[\"CUST_BUYER\"].setValue(combo.getStore().getAt(index).get(\"NAME\"));\n  \tapp.CUST_ID.setValue(records[0].get(\"ID\"));\n}else{\n\tapp[\"CUST_BUYER\"].setValue(\"\");\n}"}},{"configs":{"tagConfigs":"{\n  columnWidth: 1 / 4\n}","itemId":"FIN_P_N","fieldLabel":"FIN P/N"},"expanded":true,"children":[{"configs":{"forceFit":"true","itemId":"pickComp","barExportAllButtons":"false","width":"500","tbar":"app.toolbar2","barExportButtons":"false","height":"250"},"expanded":true,"children":[{"configs":{"itemId":"store","url":"m?xwl=my/sales/product/product-list"},"expanded":false,"children":[],"type":"store"},{"configs":{"itemId":"columns"},"expanded":false,"children":[{"configs":{"itemId":"numCol","xtype":"rownumberer","width":"30"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_P_NCol","dataIndex":"FIN_P_N","flex":"1","text":"零件号"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_P_N_REVCol","dataIndex":"FIN_P_N_REV","flex":"1","text":"版本"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"RAW_P_NCol","dataIndex":"RAW_P_N","flex":"1","text":"毛坯号"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"RAW_P_N_REVCol","dataIndex":"RAW_P_N_REV","flex":"1","text":"毛坯版本"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_DWGCol","dataIndex":"FIN_DWG","flex":"1","text":"成品图纸"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_DWG_REVCol","dataIndex":"FIN_DWG_REV","flex":"1","text":"图纸版本"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"typCol","dataIndex":"typ","width":"50","text":"类型"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"ext1Col","dataIndex":"ext1","flex":"1","text":"产品描述一"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"ext2Col","dataIndex":"ext2","flex":"1","text":"产品描述二"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"ext3Col","dataIndex":"ext3","flex":"1","text":"产品描述三"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"ext4Col","dataIndex":"ext4","flex":"1","text":"产品描述四"},"expanded":false,"children":[],"type":"column"}],"type":"array"}],"type":"grid","events":{"itemclick":"var picker = this.ownerCmp,fin_p_n = record.data.FIN_P_N,obj = record.data;\nif(fin_p_n){\n  picker.setValue(fin_p_n);\n  //根据零件号查询历史记录\n  Ext.Ajax.request({\n    url: 'm?xwl=my/sales/offer/offer-list-select-by-FIN_P_N',\n    method: \"GET\",\n    async: false,   //ASYNC 是否异步( TRUE 异步 , FALSE 同步)\n    params: {      \n      FIN_P_N:fin_p_n\n    },\n    success: function(resp, opts) {\n       //TODO 在这里给页面元素填充数据\n      var res = Wb.decode(resp.responseText);\n      if(res.rows && res.rows.length >0){\n        obj = res.rows[0];\n      }\n    }, //请求成功的回调函数 \n    failure: function() { alert(\"获取记录请求失败！\"); }  // 请求失败的回调函数\n  });\n  \n  picker.collapse();\n}\n","resize":"grid.setWidth(888);"}}],"type":"picker"}],"type":"panel"},{"configs":{"layout":"column","border":"false","itemId":"panel2"},"expanded":false,"children":[{"configs":{"tagConfigs":"{\n  columnWidth: 1 / 4\n}","itemId":"QUOTE_DATE","fieldLabel":"QUOTE DATE","format":"Y/m/d"},"expanded":false,"children":[],"type":"date"},{"configs":{"tagConfigs":"{\n  columnWidth: 1 / 4\n}","itemId":"SALES_PERSON","bindField":"USER_NAME","fieldLabel":"SALES PERSON","displayField":"USER_NAME"},"expanded":true,"children":[{"configs":{"itemId":"store","url":"m?xwl=my/sales/offer/user-list"},"expanded":false,"children":[],"type":"store","events":{"load":"if(records.length>0){\n\tfor(var i=0;i<records.length;i++){\n    \tif(records[i].get(\"USER_NAME\") == \"admin\"){\n        \tstore.remove(records[i]);\n        }\n    }\n}"}}],"type":"combo","events":{"select":"var uid = records[0].get(\"USER_ID\");\nif(uid){\n  app.SALES_PERSON_ID.setValue(uid);\n}\n"}},{"configs":{"tagConfigs":"{\n  columnWidth: 1 / 4\n}","itemId":"RFQ_REF","labelAlign":"left","fieldLabel":"RFQ REF"},"expanded":false,"children":[],"type":"text"},{"configs":{"tagConfigs":"{\n  columnWidth: 1 / 4\n}","itemId":"RFQ_DATE","fieldLabel":"RFQ DATE","format":"Y/m/d"},"expanded":false,"children":[],"type":"date"}],"type":"panel"},{"configs":{"layout":"column","border":"false","itemId":"panel3"},"expanded":true,"children":[{"configs":{"tagConfigs":"{\n  columnWidth: 1 / 4\n}","itemId":"DESC","labelAlign":"left","fieldLabel":"DESC"},"expanded":false,"children":[],"type":"text"}],"type":"panel"}],"type":"panel"}],"type":"form"},{"configs":{"itemId":"grid1","editable":"true","title":"DATA RESULT","multiSelect":"true","height":"500"},"expanded":true,"children":[{"configs":{"itemId":" columns"},"expanded":false,"children":[{"configs":{"itemId":"rownumberer","xtype":"rownumberer"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"ID","hidden":"true","dataIndex":"ID","text":"ID"},"expanded":true,"children":[],"type":"column"},{"configs":{"itemId":"QUOTE_NO","dataIndex":"QUOTE_NO","text":"QUOTE NO"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"QUOTE_DATE","dataIndex":"QUOTE_DATE","text":"QUOTE DATE"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"SALES_PERSON","dataIndex":"SALES_PERSON","text":"SALES PERSON"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"RFQ_REF","dataIndex":"RFQ_REF","text":"RFQ REF"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"RFQ_DATE","dataIndex":"RFQ_DATE","text":"RFQ DATE"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"RFQ_NOTES","dataIndex":"RFQ_NOTES","text":"RFQ NOTES"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"CUST","dataIndex":"CUST","text":"CUST"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"CUST_BUYER","dataIndex":"CUST_BUYER","text":"CUST/BUYER"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_P_N","dataIndex":"FIN_P_N","text":"FIN P/N"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_P_N_REV","dataIndex":"FIN_P_N_REV","text":"FIN P/N REV"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"PART_LONG_DESC","dataIndex":"PART_LONG_DESC","text":"PART LONG DESC"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"QTY","dataIndex":"QTY","text":"QTY"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"UOM","dataIndex":"UOM","text":"UOM"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_PT_EST_WT","dataIndex":"FIN_PT_EST_WT","text":"FIN PT EST WT(KG)"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_DWG","dataIndex":"FIN_DWG","text":"FIN DWG"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FIN_DWG_REV","dataIndex":"FIN_DWG_REV","text":"FIN DWG REV"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"RAW_P_N","dataIndex":"RAW_P_N","text":"RAW P/N"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"RAW_P_N_REV","dataIndex":"RAW_P_N_REV","text":"RAW P/N REV"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"MAT_L_SPEC_REV","dataIndex":"MAT_L_SPEC_REV","text":"MAT'L SPEC & REV"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"MAT_L_GRADE","dataIndex":"MAT_L_GRADE","text":"MAT'L GRADE"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"MAT_L_MYS","dataIndex":"MAT_L_MYS","text":"MAT'L  MYS"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"MAT_L_SIZE","dataIndex":"MAT_L_SIZE","text":"MAT'L SIZE"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FORGING_WT","dataIndex":"FORGING_WT","text":"FORGING WT(KG)"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FORGING_UNIT_PRICE","dataIndex":"FORGING_UNIT_PRICE","text":"FORGING UNIT PRICE(￥/KG)"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FORGING_COST","dataIndex":"FORGING_COST","text":"FORGING COST(￥)"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FORGING_SUPPLIER","dataIndex":"FORGING_SUPPLIER","text":"FORGING  SUPPLIER"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"HT_WT","dataIndex":"HT_WT","text":"HT WT(KG)"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"HT_UNIT_PRICE","dataIndex":"HT_UNIT_PRICE","text":"HT UNIT PRICE(￥/KG)"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"H_T_COST","dataIndex":"H_T_COST","text":"H/T COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"QTC_COST","dataIndex":"QTC_COST","text":"QTC COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"TESTING_COST","dataIndex":"TESTING_COST","text":"TESTING COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"TOTAL_RAW_COST","dataIndex":"TOTAL_RAW_COST","text":"TOTAL RAW COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"RAW_TPI","dataIndex":"RAW_TPI","text":"RAW TPI（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"CERT_COST_3_2","dataIndex":"CERT_COST_3_2","text":"3.2CERT COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"M_C_COST","dataIndex":"M_C_COST","text":"M/C COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"SPECIAL_M_C_COST","dataIndex":"SPECIAL_M_C_COST","text":"SPECIAL M/C COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"WELDING_COST","dataIndex":"WELDING_COST","text":"WELDING COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"WPS_COST","dataIndex":"WPS_COST","text":"WPS COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"NDE_COST","dataIndex":"NDE_COST","text":"NDE COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FUNCT_TEST_COST","dataIndex":"FUNCT_TEST_COST","text":"FUNCT TEST COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"TPI_COST","dataIndex":"TPI_COST","text":"TPI COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"COATING_COST","dataIndex":"COATING_COST","text":"COATING COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"PKG_COST","dataIndex":"PKG_COST","text":"PKG COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"FRT_COST","dataIndex":"FRT_COST","text":"FRT COST（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"UNIT_COST_INCL_17_VAT","dataIndex":"UNIT_COST_INCL_17_VAT","text":"UNIT COST（￥） INCL 17% VAT"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"UNIT_COST_EXCL_17_VAT","dataIndex":"UNIT_COST_EXCL_17_VAT","text":"UNIT COST（￥） EXCL 17% VAT"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"MARGING","dataIndex":"MARGING","text":"MARGING（￥）"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"SHIPPING_COST","dataIndex":"SHIPPING_COST","text":"SHIPPING COST(￥)"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"INCOTERMS","dataIndex":"INCOTERMS","text":"INCOTERMS"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"OFFER_EXCL_17_VAT","dataIndex":"OFFER_EXCL_17_VAT","text":"OFFER(￥)  EXCL 17% VAT"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"OFFER_INCL_17_VAT","dataIndex":"OFFER_INCL_17_VAT","text":"OFFER(￥)  INCL 17% VAT"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"EXCHANGE_RATE","dataIndex":"EXCHANGE_RATE","text":"EXCHANGE RATE"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"OFFER","dataIndex":"OFFER","text":"OFFER($)"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"LEAD_TIME","dataIndex":"LEAD_TIME","text":"LEAD TIME"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"OFFER_NOTES","dataIndex":"OFFER_NOTES","text":"OFFER NOTES"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"CREATOR","hidden":"true","dataIndex":"CREATOR","text":"CREATOR"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"CREATER_TIME","hidden":"true","dataIndex":"CREATER_TIME","text":"CREATER TIME"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"UPDATOR","hidden":"true","dataIndex":"UPDATOR","text":"UPDATOR"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"UPDATE_TIME","hidden":"true","dataIndex":"UPDATE_TIME","text":"UPDATE TIME"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"DEL","hidden":"true","dataIndex":"DEL","text":"DEL"},"expanded":false,"children":[],"type":"column"}],"type":"array"},{"configs":{"itemId":"store","showMask":"true","autoLoad":"true","pageSize":"15","url":"m?xwl=my/sales/offer/select"},"expanded":false,"children":[],"type":"store"}],"type":"grid"}],"type":"container"}],"type":"viewport"}],"type":"module"}],"roles":{"default":1,"manager":1,"user":1},"title":"OFFER LIST","iconCls":"table_icon","inframe":false,"pageLink":""}