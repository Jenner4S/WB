{"hidden":true,"children":[{"configs":{"head":"<style type=\"text/css\">\n.dataset table{border-collapse:collapse;border-spacing:0;border-left:1px solid #000;border-top:1px solid #000;}\n.dataset th,.dataset td{border-right:1px solid #000;border-bottom:1px solid #000;padding:5px 15px;}\n.dataset th{font-weight:bold;}\nul {\nmargin: 0px 0px 0px 0px;\npadding: 0px 0px 0px 0px;\n}\nul li{\nlist-style-type:none;\n}\n<\/style>","itemId":"module"},"expanded":true,"children":[{"configs":{"itemId":"viewport1","html":"<style type=\"text/css\">\n.dataset table{border-collapse:collapse;border-spacing:0;border-left:1px solid #000;border-top:1px solid #000;}\n.dataset th,.dataset td{border-right:1px solid #000;border-bottom:1px solid #000;padding:5px 15px;}\n.dataset th{font-weight:bold;}\nul {\nmargin: 0px 0px 0px 0px;\npadding: 0px 0px 0px 0px;\n}\nul li{\nlist-style-type:none;\n}\n<\/style>\n\n<div  id=\"div1\" style=\"width: 1200px;height: 90%;overflow-y: auto;\">\n    <table width=\"100%\">\n        <tr>\n            <td>\n                <table width=\"100%\">\n                    <tr>\n                        <td rowspan=\"3\" width=\"100px\" style=\"padding-left:10px\"><img src=\"wb/images/site/sales_ht.png\"/><\/td>\n                        <td colspan=\"11\" style=\"text-align: center;font-weight: 700;font-size: 17pt\">WELLHEAD SOLUTIONS CO., LTD.<\/td>\n                    <\/tr>\n                    <tr>\n                        <td colspan=\"12\" style=\"text-align: center;font-weight: 700;font-size: 10pt\">NO 888 ZHONGQIANG ROAD, MAOGANG TOWN,SONGJIANG ,SHANGHAI CHINA.201607 TEL: 86-21-57868786  FAX: 86-21-57866958<\/td>\n                    <\/tr>\n                    <tr>\n                        <td colspan=\"12\" style=\"text-align: center;font-weight: 700;font-size: 15pt;height: 30px;\">QUOTATION SHEET<\/td>\n                    <\/tr>\n                <\/table>\n            <\/td>\n        <\/tr>\n        <tr>\n            <td colspan=\"12\">&nbsp;<\/td>\n        <\/tr>\n        <tr>\n            <td>\n                <table width=\"100%\">\n                    <td colspan=\"4\" width=\"33%\">\n                        <table width=\"100%\" style=\"border: 1px solid #000\" id=\"TOUSERTB\">\n                            <tr>\n                                <td>TO.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"TO\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>ATTN.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"ATTN\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>ADD.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"ADD\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>TEL/FA.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"TEL\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>EMAIL.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"EMAIL\"><\/td>\n                            <\/tr>\n                        <\/table>\n                    <\/td>\n                    <td colspan=\"3\" width=\"25%\">&nbsp;<\/td>\n                    <td colspan=\"5\" width=\"42%\">\n                        <table width=\"100%\" style=\"border: 1px solid #000\"  id=\"QUOTETB\">\n                            <tr>\n                                <td>OUR REF.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"QUOTE_NO\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>REV.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"REV\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>DATE.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\"  id=\"QUOTE_DATE\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>Salesperson.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\"  id=\"CUST_BUYER\"><\/td>\n                            <\/tr>\n                            <tr>\n                                <td>EMAIL.<\/td>\n                                <td><input type=\"text\" style=\"width: 95%\" id=\"CUST_EMAIL\"><\/td>\n                            <\/tr>\n                        <\/table>\n                    <\/td>\n                <\/table>\n            <\/td>\n        <\/tr>\n        <tr>\n            <td colspan=\"12\" height=\"30px\"><\/td>\n        <\/tr>\n        <tr>\n            <td colspan=\"12\">\n                <table width=\"100%\" class=\"dataset\" style=\"border: 1px solid #000\" cellpadding=\"0\" cellspacing=\"0\">\n                  \t<thead>  \n                  \t<tr style=\"    background: #00CC99;\">\n                        <th>ITEM<\/th>\n                        <th>PART NO<\/th>\n                      \t<th>DESCRIPTION<\/th>\n                        <th>QTY<\/th>\n                        <th>UNIT<\/th>\n                      \t<th>UNIT PRICE<\/th>\n                        <th>EXT PRICE<\/th>\n                        <th>LEAD TIME<\/th>\n                        <th>NOTES<\/th>\n                    <\/tr>\n                    <\/thead>\n                  \t<tbody id=\"datasetTbody\">\n                    \n                  \t<\/tbody>\n                <\/table>\n            <\/td>\n        <\/tr>\n        <tr style=\"height:10px;\">\n            <td>&nbsp;<\/td>\n        <\/tr>\n        <tr>\n            <td>\n                <table width=\"100%\">\n                    <tr>\n                        <td style=\"text-align: left;font-weight: 700;font-size: 17pt\">NOTES:<\/td>\n                    <\/tr>\n                    <tr>\n                        <td style=\"border: 1px solid #000\">\n                            <ul id=\"notesUl\">\n                                \n                            <\/ul>\n                        <\/td>\n                    <\/tr>\n                <\/table>\n            <\/td>\n        <\/tr>\n        <tr>\n            <td>\n                <table width=\"100%\" id=\"LU_TB\">\n                    <tr>\n                        <td width=\"12%\">\n                            报价人\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"BAOJIAREN\" />\n                        <\/td>\n                        <td width=\"12%\">\n                            审核人\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"SHENHEREN\" />\n                        <\/td>\n                        <td width=\"12%\">\n                            批准\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"PIZHUN\" />\n                        <\/td>\n                    <\/tr>\n                    <tr>\n                        <td width=\"12%\">\n                            日期\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"BAOJIA_DATE\" />\n                        <\/td>\n                        <td width=\"12%\">\n                            日期\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"SHENHEREN_DATE\" />\n                        <\/td>\n                        <td width=\"12%\">\n                            日期\n                        <\/td>\n                      \t<td width=\"21%\">\n                            <input type=\"text\" width=\"200px\" value=\"\" id=\"PIZHUN_DATE\" />\n                        <\/td>\n                    <\/tr>\n                <\/table>\n            <\/td>\n        <\/tr>\n    <\/table>\n<\/div>"},"expanded":true,"children":[{"configs":{"itemId":"panel1"},"expanded":true,"children":[{"configs":{"itemId":"exportBtn","text":"导出Excel"},"expanded":false,"children":[],"type":"button","events":{"click":"/*\n * 从界面上获取到所有html的字段id和value\n * \n */\nvar list = document.getElementsByTagName(\"input\");\nvar params = {};\nfor(var i=0;i<list.length;i++){\n    if(list[i].type==\"text\"){\n\t\tparams[list[i].id] = list[i].value;\n    }\n}\n\n\nvar datasetTbody = document.getElementById(\"datasetTbody\");\nvar sum_val = 0;\nfor(var i=0;i<datasetTbody.rows.length;i++){\n\tvar cell = datasetTbody.rows[i].cells;\n\n  \tparams[\"ITEM\"+i.toString()] = cell[0].innerText;\n  \tparams[\"FINISH_P_N\"+i.toString()] = cell[1].innerText;\n  \tparams[\"DESC\"+i.toString()] = cell[2].innerText;\n  \tparams[\"QTY\"+i.toString()] = cell[3].innerText;\n  \tparams[\"UOM\"+i.toString()] = cell[4].innerText;\t\n  \tparams[\"UNIT_PRICE_EXCLUE_VAT\"+i.toString()] = cell[5].innerText;\n  \tparams[\"EXT_PRICE_EXCLUDE_VAT\"+i.toString()] = cell[6].innerText;\n  \tparams[\"LEAD_TIME\"+i.toString()] = cell[7].innerText;\n  \tparams[\"NOTES\"+i.toString()] = cell[8].innerText;\n  \n  \tsum_val += Number(cell[6].innerText);\n}\nparams[\"sum_val\"] = String(sum_val);\nfor(var i=datasetTbody.rows.length;i<30;i++){\n\tparams[\"ITEM\"+i.toString()] = \"\";\n  \tparams[\"FINISH_P_N\"+i.toString()] = \"\";\n  \tparams[\"DESC\"+i.toString()] = \"\";\n  \tparams[\"QTY\"+i.toString()] = \"\";\n  \tparams[\"UOM\"+i.toString()] = \"\";\t\n  \tparams[\"UNIT_PRICE_EXCLUE_VAT\"+i.toString()] = \"\";\n  \tparams[\"EXT_PRICE_EXCLUDE_VAT\"+i.toString()] = \"\";\n  \tparams[\"LEAD_TIME\"+i.toString()] = \"\";\n  \tparams[\"NOTES\"+i.toString()] = \"\";\n}\n/*\nif(offerList && offerList.length >0){\n  params.offerList = offerList;\n}*/\n\nvar notesUls  = document.getElementsByName(\"notesUl\");\nvar index = 0;\nvar noteStr = \"\";\nfor(var i=0;i<notesUls.length;i++){\n    if(notesUls[i].checked){\n \t\tvar txt = notesUls[i].parentNode.innerText.trim();\n      \ttxt = txt.substring(txt.indexOf(\".\"));\n        noteStr += (index+1) + txt + \"\\n\";\n        index++;\n    }\n}\n\nparams.notesUl = noteStr;\n\nWb.download('m?xwl=my/sales/export_excel/exportExcel', {\n  filename: 'filename',\n  title: '标题',\n  jsonStr : Ext.JSON.encode(params)\n});"}}],"type":"panel"}],"type":"viewport"}],"type":"module","events":{"initialize":"//\nvar offerList = {};\nvar ids = '{#id#}';\nif(ids == null || ids == \"\"){\n\tids = 1;\n}\nWb.request({\n  url: 'm?xwl=my/sales/offer/offer-select-by-IDs',\n  params : {\n  \tIDS : ids\n  },\n  success: function(resp) {\n//WebUtil.forward(request, response, 'dbe'); //转发到数据库浏览器\n    var obj = Ext.JSON.decode(resp.responseText);\n\tif(obj != null && obj.rows.length >0){\n      offerList = obj.rows;\n      \n      document.getElementById(\"TO\").value = obj.rows[0].SALES_PERSON;\n      document.getElementById(\"QUOTE_NO\").value = obj.rows[0].QUOTE_NO;\n      document.getElementById(\"REV\").value = obj.rows[0].FIN_P_N_REV;\n      document.getElementById(\"QUOTE_DATE\").value = obj.rows[0].QUOTE_DATE;\n      document.getElementById(\"CUST_BUYER\").value = obj.rows[0].CUST_BUYER;\n      document.getElementById(\"CUST_EMAIL\").value = obj.rows[0].EMAIL;\n      //document.getElementById(\"RFQ_REF\").value = obj.rows[0].RFQ_REF;\n      \n      var htmlStr = \"\";\n      var datasetTbody = document.getElementById(\"datasetTbody\");\n      Ext.each(obj.rows, function(obj, index) {  \n        \n        htmlStr += \"<tr>\" \n        \t\t+ \"<td>\" + (index + 1) + \"<\/td>\"\n        \t\t+ \"<td>\" + toString(obj.FIN_P_N) + \"<\/td>\"\n                + \"<td>\" + toString(obj.PART_LONG_DESC) + \"<\/td>\"\n                + \"<td>\" + toString(obj.QTY) + \"<\/td>\"\n        \t\t+ \"<td>\" + toString(obj.UOM) + \"<\/td>\"\t\n        \t\t+ \"<td>\" + toString(obj.UNIT_COST_EXCL_17_VAT) + \"<\/td>\"\n        \t\t+ \"<td>\" + toString(obj.UNIT_COST_INCL_17_VAT) + \"<\/td>\"\n        \t\t+ \"<td>\" + toString(obj.LEAD_TIME) + \"<\/td>\"\n        \t\t+ \"<td>\" + toString(obj.RFQ_NOTES) + \"<\/td>\"\n        \t\t+ \"<\/tr>\";\n        /*datasetTbody.rows[index].cells[0].innerHTML = obj.QUOTE_NO;\n        datasetTbody.rows[index].cells[1].innerHTML = obj.FIN_P_N;\n        datasetTbody.rows[index].cells[2].innerHTML = obj.FIN_P_N_REV;\n        datasetTbody.rows[index].cells[3].innerHTML = obj.RFQ_NOTES;\n        datasetTbody.rows[index].cells[4].innerHTML = obj.QTY;\n        datasetTbody.rows[index].cells[5].innerHTML = obj.UOM;\n        datasetTbody.rows[index].cells[6].innerHTML = obj.MAT_L_GRADE;\n        datasetTbody.rows[index].cells[7].innerHTML = obj.UNIT_COST_EXCL_17_VAT;\n        datasetTbody.rows[index].cells[8].innerHTML = obj.UNIT_COST_INCL_17_VAT;\n        datasetTbody.rows[index].cells[9].innerHTML = obj.EXCHANGE_RATE;\n        datasetTbody.rows[index].cells[10].innerHTML = obj.OFFER;\n        datasetTbody.rows[index].cells[11].innerHTML = obj.LEAD_TIME;*/\n        \n      }); \n      datasetTbody.innerHTML = htmlStr;\n      }\n    }\n});\n\nWb.request({\n  url: 'm?xwl=my/sales/export_excel/notes-select',\n  success: function(resp) {\n//WebUtil.forward(request, response, 'dbe'); //转发到数据库浏览器\n    var ret = Ext.JSON.decode(resp.responseText);\n    if(ret.rows != null && ret.rows.length>0){\n    \tvar ul = document.getElementById(\"notesUl\");\n      \tvar liStr = \"\";\n      \tfor(var i=0;i<ret.rows.length;i++){\n        \tliStr += '<li><label><input type=\"checkbox\" name=\"notesUl\"> ' + (i+1) + \".\" + ret.rows[i].V + '<\/label><\/li>';\n        }\n      \tul.innerHTML = liStr;\n    }\n  }\n});\n\n\nfunction toString(value){\n\treturn value == null ? \"\" : value;\n}\n"}}],"roles":{"default":1,"manager":1,"user":1},"title":"导出html界面","iconCls":"","inframe":false,"pageLink":""}